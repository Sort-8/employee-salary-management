<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org" xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<head th:replace="header :: header('用户管理')"></head>
<body>
<div th:replace="header :: footer"></div>
<div class="layuimini-container">
    <div class="layuimini-main">
        <!--头部工具栏-->
        <script type="text/html" id="headerToolBar">
            <form class="layui-form layui-form-pane" style="background-color: #FFFFFF" action="">
                <div class="layui-form-item">
                    <div class="layui-inline">
                        <label class="layui-form-label">用户帐号</label>
                        <div class="layui-input-inline">
                            <input type="text"  id="user_id" style="height: 38px" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-inline">
                        <label class="layui-form-label">手机号码</label>
                        <div class="layui-input-inline">
                            <input type="text" id="phone" style="height: 38px" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-inline">
                        <label class="layui-form-label">用户状态</label>
                        <div class="layui-input-inline">
                            <select id="user_status">
                                <option valie="0">所有</option>
                                <option valie="0">正常</option>
                                <option valie="1">停用</option>
                            </select>
                        </div>
                    </div>
                    <div class="layui-inline">
                        <button type="button" class="layui-btn layui-btn-primary " id="search" lay-event="search" >
                        <i class="layui-icon"></i>
                    </button>
                    </div>
                </div>
            </form>
        </script>

        <!--表格-->
        <table class="layui-hide" id="layui-table" lay-filter="layui-table"></table>

        <!--侧边栏-->
        <script type="text/html" id="sideToolBar">
            {{#  if(d.user_id!=1){ }}
                <a class="layui-btn layui-btn-xs  layui-icon-more layui-icon" lay-event="more"></a>
                <a class="layui-btn layui-btn-xs layui-icon-edit layui-icon" lay-event="edit"></a>
                <a class="layui-btn layui-btn-xs layui-icon-refresh layui-icon" lay-event="reset"></a>
                <a class="layui-btn layui-btn-xs layui-btn-danger layui-icon-delete layui-icon"
                   lay-event="delete"></a>
            {{#  } }}
        </script>

        <!--侧边栏状态开关-->
        <script type="text/html" id="status">
            {{#  if(d.user_id!=1){ }}
                <input type="checkbox" name = "status" value = {{d.user_id}}
                   lay-skin="switch" lay-filter="status" {{ d.status == '0' ? 'checked' : '' }}>
            {{#  } }}
        </script>
    </div>
</div>
<script type="text/javascript">
    var defaultToolbar=[];
    if(true){
        defaultToolbar.push({
            title: '添加用户',
            layEvent: 'insert',
            icon: 'layui-icon-add-1'
        });
    }
    if(true){
        defaultToolbar.push({
            title: '批量删除',
            layEvent: 'delete',
            icon: 'layui-icon-delete'
        });
    }
    if(true){
        defaultToolbar.push({
            title: '导出数据',
            layEvent: 'export',
            icon: 'layui-icon-export'
        });
    }
    defaultToolbar.push( 'filter');

    var options={
        elem: '#layui-table',
        url: crx+'/user/getPageUser',
        toolbar:'#headerToolBar',
        headers:{
            token:$.cache.get("user").user.token,
            login_name:$.cache.get("user").user.login_name
        },
        defaultToolbar: defaultToolbar,
        cols: [{
                type: "checkbox",
            },
            {
                type:'numbers',
                title: '序号',
            },
            {
                field:'login_name',
                title: '登录名称',
            },
            {
                field:'user_name',
                title: '用户名称',
            },
            {
                field:'dept_name',
                title: '部门',
            },
            {
                field:'email',
                title: '邮箱',
                hide:true
            },
            {
                field:'phone_number',
                title: '手机',
            },
            {
                field:'status',
                title: '状态',
                templet:'#status'
            },
            {
                field:'create_time',
                title: '创建时间',
                sort: true,
            },
            {
                fixed: 'right',
                title: '操作',
                toolbar: '#sideToolBar',
            }
        ],
        parseData: function (result) {
            if(result.code===0){
                return {
                    "code": result.code,//解析接口状态
                    "msg": result.msg,//解析提示文本
                    "count": result.data.total,//解析数据长度
                    "data": result.data.list//解析数据列表
                };
            }else{
                $.modal.msgError('表格加载失败',function () {});
            }
        },
    };
    $.table.init(options);
</script>
</body>
</html>